---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "beget_compute_instance Resource - Beget"
description: |-
  Compute instance resource. Manages virtual private servers with configurable CPU, RAM, disk, and network settings.
---

# beget_compute_instance (Resource)

Compute instance resource. Manages virtual private servers with configurable CPU, RAM, disk, and network settings.

## Image Sources

The `image` block supports two mutually exclusive ways to specify the instance image:

- **`snapshot_id`**: Create instance from an existing snapshot. Use this to restore a backup or clone an existing instance.
- **`software`**: Install marketplace software (e.g., Ubuntu, ISP Manager). Use this for fresh installations.

Exactly one of `snapshot_id` or `software` must be specified.

### Software Installation

When using `software`, you can optionally provide:

- `id`: Software ID from the marketplace catalog (use `beget_softwares` or `beget_software` data sources)
- `isp_license_id`: Required when installing ISP Manager software
- `vars`: Installation variables (key-value pairs) specific to the software

## Example Usage
```terraform
# Get Ubuntu 24.04 software details
data "beget_software" "ubuntu" {
  slug = "ubuntu-24-04"
}

# Create SSH key for instance access
resource "beget_ssh_key" "main" {
  name       = "my-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user@example.com"
}

# Create compute instance with Ubuntu from marketplace
resource "beget_compute_instance" "ubuntu" {
  name        = "my-ubuntu-server"
  description = "Basic Ubuntu server"
  region      = "ru1"

  configuration = {
    cpu       = 2
    ram_mb    = 2048
    disk_mb   = 20480
    cpu_class = "normal_cpu"
  }

  image = {
    software = {
      id = data.beget_software.ubuntu.id
    }
  }

  access = {
    ssh_keys = [beget_ssh_key.main.id]
  }
}

output "instance" {
  value = {
    id         = beget_compute_instance.ubuntu.id
    ip_address = beget_compute_instance.ubuntu.ip_address
    status     = beget_compute_instance.ubuntu.status
  }
}
```
```terraform
# Create SSH keys for instance access
resource "beget_ssh_key" "key1" {
  name       = "key-1"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user1@example.com"
}

resource "beget_ssh_key" "key2" {
  name       = "key-2"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuv user2@example.com"
}

# Create compute instance from existing snapshot
resource "beget_compute_instance" "from_snapshot" {
  name   = "restored-server"
  region = "ru1"

  configuration = {
    cpu       = 4
    ram_mb    = 4096
    disk_mb   = 40960
    cpu_class = "normal_cpu"
  }

  image = {
    snapshot_id = 12345 # Snapshot ID
  }

  access = {
    ssh_keys = [beget_ssh_key.key1.id, beget_ssh_key.key2.id]
  }
}

output "restored_instance" {
  value = {
    id         = beget_compute_instance.from_snapshot.id
    ip_address = beget_compute_instance.from_snapshot.ip_address
  }
}
```
```terraform
# Get ISP Manager software details
data "beget_software" "ispmanager" {
  slug = "ispmanager"
}

# Get ISP Manager Host license
data "beget_isp_license" "host" {
  plan = "Host"
}

# Create SSH key for instance access
resource "beget_ssh_key" "main" {
  name       = "my-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user@example.com"
}

# Create compute instance with ISP Manager
resource "beget_compute_instance" "ispmanager" {
  name        = "ispmanager-server"
  hostname    = "isp.example.com"
  description = "ISP Manager hosting server"
  region      = "ru1"

  configuration = {
    cpu       = 4
    ram_mb    = 8192
    disk_mb   = 102400
    cpu_class = "normal_cpu"
  }

  image = {
    software = {
      id             = data.beget_software.ispmanager.id
      isp_license_id = data.beget_isp_license.host.id
    }
  }

  access = {
    ssh_keys = [beget_ssh_key.main.id]
  }
}

output "ispmanager_instance" {
  value = {
    id         = beget_compute_instance.ispmanager.id
    ip_address = beget_compute_instance.ispmanager.ip_address
    status     = beget_compute_instance.ispmanager.status
  }
}
```
```terraform
# Get Ubuntu 24.04 software details
data "beget_software" "ubuntu" {
  slug = "ubuntu-24-04"
}

# Create private network
resource "beget_private_network" "main" {
  region = "ru1"
}

# Create SSH key for instance access
resource "beget_ssh_key" "main" {
  name       = "my-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user@example.com"
}

# Create compute instance with private network
resource "beget_compute_instance" "with_pn" {
  name   = "server-with-pn"
  region = "ru1"

  configuration = {
    cpu       = 2
    ram_mb    = 2048
    disk_mb   = 20480
    cpu_class = "normal_cpu"
  }

  image = {
    software = {
      id = data.beget_software.ubuntu.id
    }
  }

  access = {
    ssh_keys = [beget_ssh_key.main.id]
  }

  private_networks = {
    (beget_private_network.main.id) = {
      address = "10.0.0.10" # Optional: specific IP in private network
    }
  }
}

output "instance_with_pn" {
  value = {
    id               = beget_compute_instance.with_pn.id
    ip_address       = beget_compute_instance.with_pn.ip_address
    private_networks = beget_compute_instance.with_pn.private_networks
  }
}
```
```terraform
# Get Ubuntu 24.04 software details
data "beget_software" "ubuntu" {
  slug = "ubuntu-24-04"
}

# Create SSH key for instance access
resource "beget_ssh_key" "main" {
  name       = "my-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user@example.com"
}

# Create compute instance with software installation variables
resource "beget_compute_instance" "with_vars" {
  name   = "custom-software-server"
  region = "ru1"

  configuration = {
    cpu       = 2
    ram_mb    = 2048
    disk_mb   = 20480
    cpu_class = "normal_cpu"
  }

  image = {
    software = {
      id = data.beget_software.ubuntu.id
      vars = {
        # Software-specific installation variables
        # Example: root_password = "secure-password-123"
        # Check software documentation for available variables
        # Use data.beget_software.<name>.variables to see available vars
      }
    }
  }

  access = {
    ssh_keys = [beget_ssh_key.main.id]
  }
}

output "instance_with_vars" {
  value = {
    id         = beget_compute_instance.with_vars.id
    ip_address = beget_compute_instance.with_vars.ip_address
  }
}
```
```terraform
# Fetch entire marketplace catalog
data "beget_softwares" "all" {}

# Create SSH key for instance access
resource "beget_ssh_key" "main" {
  name       = "my-key"
  public_key = "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOw9mSAEkEDdWJbFMyRYz78HhT4qeZtTJRTQjgsCBoFv user@example.com"
}

# Create compute instance using software from catalog map
resource "beget_compute_instance" "from_catalog" {
  name   = "server-from-catalog"
  region = "ru1"

  configuration = {
    cpu       = 2
    ram_mb    = 2048
    disk_mb   = 20480
    cpu_class = "normal_cpu"
  }

  image = {
    software = {
      id = data.beget_softwares.all.softwares["ubuntu-24-04"].id
    }
  }

  access = {
    ssh_keys = [beget_ssh_key.main.id]
  }
}

output "instance_from_catalog" {
  value = {
    id         = beget_compute_instance.from_catalog.id
    ip_address = beget_compute_instance.from_catalog.ip_address
    software   = data.beget_softwares.all.softwares["ubuntu-24-04"].display_name
  }
}
```
<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `access` (Attributes) (see [below for nested schema](#nestedatt--access))
- `configuration` (Attributes) (see [below for nested schema](#nestedatt--configuration))
- `image` (Attributes) (see [below for nested schema](#nestedatt--image))
- `name` (String) Compute Instance name
- `region` (String) Region where the compute instance will be created. Changing this field will recreate the instance

### Optional

- `description` (String) Description of the compute instance
- `hostname` (String) Hostname of the compute instance. If not provided, will be auto-generated
- `private_networks` (Attributes Map) Private network configuration. Currently supports only one private network (see [below for nested schema](#nestedatt--private_networks))

### Read-Only

- `date_create` (String) Creation date of the compute instance
- `id` (String) Compute Instance ID
- `ip_address` (String) Public IP address of the compute instance
- `slug` (String) Compute Instance slug identifier
- `software_domain` (String) Software domain assigned to the compute instance
- `status` (String) Current status of the compute instance
- `technical_domain` (String) Technical domain assigned to the compute instance

<a id="nestedatt--access"></a>
### Nested Schema for `access`

Required:

- `ssh_keys` (List of Number) List of SSH key IDs to attach to the instance


<a id="nestedatt--configuration"></a>
### Nested Schema for `configuration`

Required:

- `cpu` (Number) Number of CPU cores
- `cpu_class` (String) CPU class identifier
- `disk_mb` (Number) Disk size in megabytes. Decreasing this value will recreate the instance
- `ram_mb` (Number) Amount of RAM in megabytes

Read-Only:

- `price_day` (Number) Daily price for this configuration
- `price_month` (Number) Monthly price for this configuration


<a id="nestedatt--image"></a>
### Nested Schema for `image`

Optional:

- `snapshot_id` (Number) Snapshot ID to use for instance creation. Exactly one of `snapshot_id` or `software` must be specified
- `software` (Attributes) (see [below for nested schema](#nestedatt--image--software))

<a id="nestedatt--image--software"></a>
### Nested Schema for `image.software`

Required:

- `id` (Number) Software ID to install on the instance

Optional:

- `isp_license_id` (Number) ISP license ID (required when installing ispmanager software)
- `vars` (Map of String) Software installation variables (key-value pairs)



<a id="nestedatt--private_networks"></a>
### Nested Schema for `private_networks`

Optional:

- `address` (String) IP address within the private network. If not specified, will be auto-assigned



